<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Text to Video Generator</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #222;
    color: #eee;
    margin: 0;
    padding: 20px;
  }

  textarea {
    width: 100%;
    height: 100px;
  }

  button {
    padding: 10px 20px;
    margin-top: 10px;
  }

  #videoPreview {
    margin-top: 20px;
  }
</style>
</head>
<body>
<h1>Text to Animated Video</h1>
<textarea id="textInput" placeholder="Enter text to animate..."></textarea>
<br />
<button onclick="generateVideo()">Generate Video</button>

<div id="videoPreview"></div>

<!-- Include Whammy.js library from CDN -->
<script src="https://cdn.jsdelivr.net/gh/antimatter15/whammy/whammy.js"></script>

<script>
async function generateVideo() {
  const text = document.getElementById('textInput').value.trim();
  if (!text) {
    alert('Please enter some text!');
    return;
  }

  const canvas = document.createElement('canvas');
  const ctx = canvas.getContext('2d');

  const width = 640;
  const height = 360;
  canvas.width = width;
  canvas.height = height;

  const totalFrames = 100; // total frames for the animation
  const frames = [];

  // Generate frames with text moving from left to right
  for (let i = 0; i < totalFrames; i++) {
    ctx.fillStyle = '#222';
    ctx.fillRect(0, 0, width, height);

    ctx.font = '30px Arial';
    ctx.fillStyle = '#fff';

    const progress = i / totalFrames;
    const x = progress * (width - 200);
    const y = height / 2;

    ctx.fillText(text, x, y);

    // Save frame as data URL
    frames.push(canvas.toDataURL('image/webp'));
  }

  // Encode frames into video using Whammy
  const encoder = new Whammy.Video(30); // 30 fps

  // Helper function to load image from data URL
  function loadImage(dataUrl) {
    return new Promise((resolve) => {
      const img = new Image();
      img.onload = () => resolve(img);
      img.src = dataUrl;
    });
  }

  // Add frames to encoder after loading images
  for (const frameDataUrl of frames) {
    const img = await loadImage(frameDataUrl);
    encoder.add(img);
  }

  // Generate the video blob
  const outputBlob = encoder.compile();

  // Create video URL and display
  const url = URL.createObjectURL(outputBlob);
  const videoContainer = document.getElementById('videoPreview');
  videoContainer.innerHTML = `<video controls width="640" height="360" src="${url}"></video>`;
}
</script>
</body>
</html>